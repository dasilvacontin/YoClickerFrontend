<!DOCTYPE html>
<html lang="en">
<title>YoClicker - <%= pollName %></title>
<%- include head.ejs %>
<meta name="viewport" content="minimal-ui">
<style type="text/css">

  .wrapper {
    box-sizing: border-box;
    width: 100%;
    height: 100%;
    padding: 20px;
  }

  .chart {
    width: 100%;
    height: 100%;
    font-size: 20px;
  }

</style>
<head>
</head>
<body>
<script src="/js/runOnLoad.js"></script>
<script src="/js/HighchartsAdapter.js" type="text/javascript"></script>
<script src="/js/highcharts.src.js" type="text/javascript"></script>
<script src='/js/yoChartTheme.js'></script>
<script>

  /*
  var series = [{
    type: 'pie',
    data: [
        ['Yehuda Katz', 450],
        ['Angus Croll', 260],
        ['Substack', 120],
        ['Justin Meyer', 80],
        ['Paul O’Shannessy', 450],
        ['John-David Dalton', 260],
        ['Domenic Denicola', 120],
        ['Julien Lecomte', 80],
        ['Soledad Penadés', 80],
        ['Joe McCann', 80],
        ['Charlie Robbins', 80],
        ['Mike McNeil', 80]
    ]
  }];
  */

  var questions = JSON.parse(unescape("<%- json %>"));

  function newChart(i, question) {

    var uid = 'chart'+i;

    var w = document.createElement('div');
    w.className = 'wrapper';
    w.setAttribute('id', uid);
    document.body.appendChild(w);

    new Highcharts.Chart({
    chart : {
      renderTo : uid,
      type     : 'pie'
    },
    credits: {
      enabled: false
    },
    title: {
        text: question.question
    },
    series: [{
      type: 'pie',
      data: question.answers
    }]
    });

  }

  // create a new chart
  runOnLoad(function(){

    for (var i = 0; i < questions.length; ++i)
      newChart(i, questions[i]);

  });

</script>
</body>
</html>